// ********************************************************************************************************************
import { abs, clampZeroOne, sqrt } from "../../helpers/math.helper";
// ********************************************************************************************************************
export class TerrainModifierWeight {

    // ****************************************************************************************************************
    // constructor
    // ****************************************************************************************************************
    constructor(public readonly x: number, public readonly y: number, public weight: number) { }

    // ****************************************************************************************************************
    // function:    generate
    // ****************************************************************************************************************
    // parameters:  radius - the radius
    // ****************************************************************************************************************
    // returns:     the weights
    // ****************************************************************************************************************
    public static generate(radius: number): TerrainModifierWeight[] {

        // ************************************************************************************************************
        // setup variables
        // ************************************************************************************************************

        const weights: TerrainModifierWeight[] = [];

        var size = radius << 1, total = 0, sx = 0, sy = 0;

        // ************************************************************************************************************
        // setup weights
        // ************************************************************************************************************

        for (var x = 0; x < size; x++, sx = x * x) {

            for (var y = 0; y < size; y++, sy = y * y) {

                const distance = sqrt(sx + sy);

                const amount = abs(1 - (distance / radius));

                const weight = new TerrainModifierWeight(x - radius, y - radius, amount);

                weights.push(weight)

                total += amount;
            }
        }

        // ************************************************************************************************************
        // setup weights normalized
        // ************************************************************************************************************

        for (var i = 0; i < weights.length; i++) {

            weights[i].weight = clampZeroOne(weights[i].weight / total);
        }
        return weights;
    }
}
