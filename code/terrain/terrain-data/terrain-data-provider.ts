// ********************************************************************************************************************
import { clampZeroOne } from '../../helpers/math.helper';
// ********************************************************************************************************************
import { Colour } from '../../types/colour';
// ********************************************************************************************************************
import { TerrainProvider } from '../terrain-provider';
// ********************************************************************************************************************
import { TerrainDataGrid } from './terrain-data-grid';
// ********************************************************************************************************************
export class TerrainDataProvider extends TerrainProvider {

    // ****************************************************************************************************************
    // offsetX - the offset x
    // ****************************************************************************************************************
    private readonly offsetX: number = 0;

    // ****************************************************************************************************************
    // offsetY - the offset y
    // ****************************************************************************************************************
    private readonly offsetY: number = 0;

    // ****************************************************************************************************************
    // constructor
    // ****************************************************************************************************************
    constructor(private readonly grid: TerrainDataGrid) {

        super();

        this.offsetX = grid.sizeX >> 1;

        this.offsetY = grid.sizeY >> 1;
    }

    // ****************************************************************************************************************
    // function:    getColour
    // ****************************************************************************************************************
    // parameters:  x - the x
    // ****************************************************************************************************************
    //              y - the y
    // ****************************************************************************************************************
    // returns:     the colour
    // ****************************************************************************************************************
    public getColour(x: number, y: number): Colour {

        const data = this.grid.get(this.offsetX + x, this.offsetY + y);

        return data.getBiomeColour();
    }

    // ****************************************************************************************************************
    // function:    getHeight
    // ****************************************************************************************************************
    // parameters:  x - the x
    // ****************************************************************************************************************
    //              y - the y
    // ****************************************************************************************************************
    // returns:     the height
    // ****************************************************************************************************************
    public getHeight(x: number, y: number): number {

        const data = this.grid.get(this.offsetX + x, this.offsetY + y);

        return clampZeroOne(data?.height ?? 0);
    }
}
